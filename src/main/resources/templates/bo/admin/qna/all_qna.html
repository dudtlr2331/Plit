<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{bo/admin/admin_layout :: layout(~{::content})}">

<div th:fragment="content">
    <div class="container-fluid px-4">
        <h1 class="mt-4">고객 문의 관리</h1>

        <!-- 필터 버튼 -->
        <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap" style="gap: 10px;">
            <div class="btn-group" role="group">
                <a th:href="@{/bo/admin/qna/list(type='ALL')}"
                   th:classappend="${type == 'ALL' or type == null} ? 'btn btn-primary' : 'btn btn-outline-primary'"
                   class="btn">전체</a>

                <a th:href="@{/bo/admin/qna/list(type='UNANSWERED')}"
                   th:classappend="${type == 'UNANSWERED'} ? 'btn btn-primary' : 'btn btn-outline-primary'"
                   class="btn">미처리</a>

                <a th:href="@{/bo/admin/qna/list(type='ANSWERED')}"
                   th:classappend="${type == 'ANSWERED'} ? 'btn btn-primary' : 'btn btn-outline-primary'"
                   class="btn">답변완료</a>
            </div>
        </div>

        <!-- 목록 테이블 -->
        <table class="table table-bordered table-hover align-middle">
            <thead class="table-light">
            <tr>
                <th>번호</th>
                <th>제목</th>
                <th>작성자</th>
                <th>상태</th>
                <th>작성일</th>
                <th>관리</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="qna : ${questions}">
                <td th:text="${qna.id}">1</td>

                <td>
                    <span th:text="${qna.title}">제목</span>
                    <span th:if="${qna.fileName != null}" title="첨부파일 있음">📎</span>
                </td>

                <td th:text="${qna.user != null ? qna.user.userId : '(탈퇴회원)'}">작성자</td>

                <td>
                    <span class="badge px-2 py-1"
                          th:classappend="${qna.status == '답변완료'} ? 'bg-success' : (qna.status == '대기중' ? 'bg-warning text-dark' : 'bg-secondary')"
                          th:text="${qna.status != null ? qna.status : '미상태'}">상태</span>
                </td>

                <td th:text="${#temporals.format(qna.askedAt, 'yyyy-MM-dd HH:mm')}">작성일</td>

                <td>
                    <a class="btn btn-sm"
                       th:classappend="${qna.status == '답변완료'} ? 'btn-secondary disabled' : 'btn-primary'"
                       th:href="${qna.status == '답변완료'} ? '#' : @{/bo/admin/qna/answer/{id}(id=${qna.id})}">
                        답변하기
                    </a>
                </td>
            </tr>
            <tr th:if="${#lists.isEmpty(questions)}">
                <td colspan="6" class="text-center text-muted">문의 내역이 없습니다.</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</html>