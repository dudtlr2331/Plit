<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title th:text="${clan.name} + ' - 클랜 정보'">클랜 정보</title>
    <link rel="stylesheet" href="/css/clan.css">
</head>
<body>

<!-- 상단 헤더 -->
<header>
    <div class="logo" onclick="location.href='/main'">plit</div>
    <nav>
        <a href="/party">파티찾기</a>
        <a href="/record">내전찾기</a>
        <a href="/clan" style="color: yellow;">클랜찾기</a>
        <a href="/report">트롤신고</a>
    </nav>
    <div style="display: flex; align-items: center; gap: 15px;">
        <div onclick="toggleChatList()" style="cursor: pointer; font-size: 30px;">💬</div>
        <div sec:authorize="isAuthenticated()" style="display: flex; align-items: center; gap: 10px;">
            <span th:text="${#authentication.name} + ' 님'" style="font-weight: bold;"></span>
            <button onclick="location.href='/mypage'">마이페이지</button>
            <button onclick="location.href='/logout'">로그아웃</button>
        </div>
        <div sec:authorize="isAnonymous()">
            <button onclick="location.href='/login'">로그인</button>
        </div>
    </div>
</header>

<!-- 상세 페이지 컨테이너 -->
<main class="detail-container">
    <!-- 상단 제목 -->
    <div class="detail-header">
        <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
            <h1 th:text="${clan.name}" style="margin: 0;">클랜 이름</h1>
            <div class="social-links" style="display: flex; gap: 12px;">
                <a th:if="${clan.discordLink != null}" th:href="${clan.discordLink}" target="_blank">
                    <img src="/images/clan/discord-icon.png" alt="Discord" class="clan-social-icon"/>
                </a>
                <a th:if="${clan.kakaoLink != null}" th:href="${clan.kakaoLink}" target="_blank">
                    <img src="/images/clan/kakao-icon.png" alt="KakaoTalk" class="clan-social-icon"/>
                </a>
            </div>
        </div>
    </div>

    <!-- 중간 내용 전체 감싸는 영역 -->
    <div class="detail-content">
        <!-- 탭 -->
        <div class="clan-tabs">
            <a class="tab active" href="#">소개</a>
            <th:block th:if="${role == 'LEADER'}">
                <a class="tab" href="#">멤버</a>
                <a class="tab" href="#">수락 대기</a>
            </th:block>
        </div>

        <!-- 이미지 -->
        <div class="detail-image">
            <img th:src="${clan.imageUrl != null ? clan.imageUrl : '/uploads/default.png'}" alt="클랜 이미지">
        </div>

        <!-- 소개 -->
        <div class="detail-intro">
            <h2>소개</h2>
            <div class="intro-content" th:utext="${clan.intro}"></div>
        </div>

        <!-- 최소 티어 -->
        <div class="detail-tier">
            <h2>가입 최소 티어</h2>
            <p th:text="${clan.minTier}">골드</p>
        </div>
    </div>

    <!-- 아래 고정 버튼 -->
    <div class="action-buttons">
        <th:block th:if="${role == 'LEADER'}">
            <a th:href="@{/clan/edit/{id}(id=${clan.id})}" class="btn">수정</a>
            <form th:action="@{/clan/delete/{id}(id=${clan.id})}" method="post" style="display: inline;">
                <button type="submit" class="btn">삭제</button>
            </form>
        </th:block>

        <th:block th:if="${role == 'MEMBER'}">
            <button class="btn">클랜 탈퇴</button>
        </th:block>

        <th:block th:if="${role == 'GUEST'}">
            <button class="btn">가입 신청</button>
        </th:block>
    </div>
</main>

<!-- 푸터 -->
<footer>
    <div class="container">
        <div class="footer-nav">
            <a href="#">공지사항</a>
            <a href="#">사용방법</a>
            <a href="#">개인정보처리방침</a>
            <a href="#">광고/제휴문의</a>
            <a href="#">개발문의</a>
            <a href="#">404 Squad</a>
        </div>
        <div>
            lol.ps is hosted by PS Analytics, Inc. This site isn't endorsed by Riot Games and doesn’t reflect their views.
            League of Legends is a trademark of Riot Games.
        </div>
    </div>
</footer>

<script>
    function toggleChatList() {
        alert('채팅 리스트 열기 구현 필요');
    }

    function showTab(tab) {
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        document.querySelectorAll('.tab-section').forEach(section => section.classList.add('hidden'));

        document.querySelector(`.tab-btn[onclick*='${tab}']`).classList.add('active');
        document.getElementById(tab).classList.remove('hidden');
    }
</script>

</body>
</html>